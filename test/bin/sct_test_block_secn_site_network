#!/bin/bash
#
# sct_test_block_secn_site_network - block all network on secondary site nodes
#
src=${BASH_SOURCE[0]}
full_path=$(readlink -f "$src")
dir_path=$(dirname "$full_path")
source .test_properties

# shellcheck disable=SC2029
ssh "${node01}" "crm resource cleanup $mstResource; cs_wait_for_idle -s 2"

currSecondary="$(ssh "${node01}" "/usr/bin/SAPHanaSR-showAttr --format=tester" | awk -F'/' '/score="100"/ { print $2 }' )"
currSecWorker="$(ssh "${node01}" "/usr/bin/SAPHanaSR-showAttr --format=tester" | awk -F'/' '/score="-12200"/ { print $2 }' )"

echo "==== Block network on secondary site node ${currSecondary} ===="
# shellcheck disable=SC2029
ssh "${currSecondary}" "rcnetwork stop & exit" &
echo "==== Block network on secondary site node ${currSecWorker} ===="
ssh "${currSecWorker}" "rcnetwork stop & exit" &
#
