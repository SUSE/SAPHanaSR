#!/bin/bash
#
# sct_test_kill_prim_worker_pacemkr-attrd - kill pacemaker-attrd on primary worker node
#
# (c) 2025 SUSE LLC
# Author: F.Herschel, L.Pinne.
# GNU General Public License v2. No warranty.
# http://www.gnu.org/licenses/gpl.html
#
set -u
src=${BASH_SOURCE[0]}
full_path=$(readlink -f "$src")
dir_path=$(dirname "$full_path")
source /usr/bin/sct_test_lib
source .test_properties
currPrimWorker="$(ssh "${node01}" "/usr/bin/SAPHanaSR-showAttr --format=tester" | awk -F'/' '/score="-10000"/ { print $2 }' )"

echo "==== Kill pacemaker-attrd ===="
# TODO signal 9 ?
kill_process "$currPrimWorker" "hacluster" "pacemaker-attrd" "11" & exit
ssh "$currPrimWorker" 'pgrep -u hacluster -f pacemaker-attrd; pkill -u hacluster -f pacemaker-attrd -11 & exit'
#
