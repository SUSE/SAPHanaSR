#!/bin/bash
#
# sct_test_kill_pacemkr-based - kill pacemaker-based
#
# PARAM: prim[:master|worker] | secn[:master|worker]
#
# (c) 2025-2026 SUSE LLC
# Author: F.Herschel, L.Pinne.
# GNU General Public License v2. No warranty.
# http://www.gnu.org/licenses/gpl.html
#
# lib-mig-status: PASSED Script:OK Test-angi_ScaleUp-kill_prim_pacemkr-based: OK
# used-in:
#   angi-ScaleUp: kill_prim_pacemkr-based
#   angi-ScaleOut: kill_prim_pacemkr-based
#   - list-end
#
set -u
srRole="$1"  # should be prim or secn
rc=1
source /usr/lib/SAPHanaSR-tester/sct_test_lib
source .test_properties
case "$srRole" in
    prim | prim:master ) killNode=$(sctl_get_curr_prim "$node01");;
    secn | secn:master ) killNode=$(sctl_get_curr_secn "$node01");;
    prim:worker        ) killNode=$(sctl_get_curr_prim_worker "$node01");;
    secn:worker        ) killNode=$(sctl_get_curr_secn_worker "$node01");;
    * ) echo "Neither prim nor secn in cmd line"
        exit 2;;
esac

echo "==== Kill pacemaker-based ===="
# TODO signal 9 ?
sctl_kill_process "$killNode" "hacluster" "pacemaker-based" "11" "flags::"; rc="$?"
exit "$rc"
#
